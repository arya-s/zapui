<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello World - GPUI Port Comparison</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #e0e0e0;
        }
        h1, h2, h3 { color: #fff; }
        h1 { border-bottom: 2px solid #3b82f6; padding-bottom: 10px; }
        h2 { border-bottom: 1px solid #333; padding-bottom: 8px; margin-top: 30px; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        
        .card {
            background: #252525;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #333;
        }
        .card h3 { margin-top: 0; color: #3b82f6; }
        
        .screenshot { max-width: 100%; border-radius: 4px; border: 1px solid #444; }
        .screenshot-container { text-align: center; }
        .screenshot-container img { max-height: 400px; object-fit: contain; }
        
        pre {
            background: #1e1e1e;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.4;
            max-height: 600px;
            overflow-y: auto;
        }
        code { font-family: 'Fira Code', 'Consolas', monospace; }
        
        .rust { border-left: 3px solid #dea584; }
        .zig { border-left: 3px solid #f7a41d; }
        
        .stats { display: flex; gap: 20px; flex-wrap: wrap; }
        .stat { background: #333; padding: 10px 20px; border-radius: 4px; }
        .stat-value { font-size: 24px; font-weight: bold; color: #3b82f6; }
        .stat-label { font-size: 12px; color: #888; }
        
        a { color: #3b82f6; }
        
        @media (max-width: 900px) { .grid, .grid-3 { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <h1>Hello World - GPUI Port Comparison</h1>
    
    <div class="stats">
        <div class="stat">
            <div class="stat-value">106</div>
            <div class="stat-label">Rust LOC</div>
        </div>
        <div class="stat">
            <div class="stat-value">209</div>
            <div class="stat-label">Zig LOC</div>
        </div>
    </div>
    
    <h2>üì∏ Screenshots</h2>
    <div class="grid-3">
        <div class="card screenshot-container">
            <h3>GPUI (Rust)</h3>
            <img src="screenshots/gpui.png" alt="GPUI" class="screenshot">
        </div>
        <div class="card screenshot-container">
            <h3>ZapUI (Zig)</h3>
            <img src="screenshots/zapui.png" alt="ZapUI" class="screenshot">
        </div>
        <div class="card screenshot-container">
            <h3>Difference</h3>
            <img src="screenshots/diff.png" alt="Diff" class="screenshot">
        </div>
    </div>
    
    <h2>üîÑ Animated Comparison</h2>
    <div class="card screenshot-container">
        <img src="screenshots/toggle.gif" alt="Toggle" class="screenshot">
    </div>
    
    <h2>üìù Source Code</h2>
    <div class="grid">
        <div class="card">
            <h3>Rust (GPUI) - hello_world.rs</h3>
            <pre class="rust"><code>use gpui::{
    App, Application, Bounds, Context, SharedString, Window, WindowBounds, WindowOptions, div,
    prelude::*, px, rgb, size,
};

struct HelloWorld {
    text: SharedString,
}

impl Render for HelloWorld {
    fn render(&amp;mut self, _window: &amp;mut Window, _cx: &amp;mut Context&lt;Self&gt;) -&gt; impl IntoElement {
        div()
            .flex()
            .flex_col()
            .gap_3()
            .bg(rgb(0x505050))
            .size(px(500.0))
            .justify_center()
            .items_center()
            .shadow_lg()
            .border_1()
            .border_color(rgb(0x0000ff))
            .text_xl()
            .text_color(rgb(0xffffff))
            .child(format!(&quot;Hello, {}!&quot;, &amp;self.text))
            .child(
                div()
                    .flex()
                    .gap_2()
                    .child(
                        div()
                            .size_8()
                            .bg(gpui::red())
                            .border_1()
                            .border_dashed()
                            .rounded_md()
                            .border_color(gpui::white()),
                    )
                    .child(
                        div()
                            .size_8()
                            .bg(gpui::green())
                            .border_1()
                            .border_dashed()
                            .rounded_md()
                            .border_color(gpui::white()),
                    )
                    .child(
                        div()
                            .size_8()
                            .bg(gpui::blue())
                            .border_1()
                            .border_dashed()
                            .rounded_md()
                            .border_color(gpui::white()),
                    )
                    .child(
                        div()
                            .size_8()
                            .bg(gpui::yellow())
                            .border_1()
                            .border_dashed()
                            .rounded_md()
                            .border_color(gpui::white()),
                    )
                    .child(
                        div()
                            .size_8()
                            .bg(gpui::black())
                            .border_1()
                            .border_dashed()
                            .rounded_md()
                            .rounded_md()
                            .border_color(gpui::white()),
                    )
                    .child(
                        div()
                            .size_8()
                            .bg(gpui::white())
                            .border_1()
                            .border_dashed()
                            .rounded_md()
                            .border_color(gpui::black()),
                    ),
            )
    }
}

fn main() {
    Application::new().run(|cx: &amp;mut App| {
        let bounds = Bounds::centered(None, size(px(500.), px(500.0)), cx);
        cx.open_window(
            WindowOptions {
                window_bounds: Some(WindowBounds::Windowed(bounds)),
                ..Default::default()
            },
            |_, cx| {
                cx.new(|_| HelloWorld {
                    text: &quot;World&quot;.into(),
                })
            },
        )
        .unwrap();
        cx.activate(true);
    });
}
</code></pre>
        </div>
        <div class="card">
            <h3>Zig (ZapUI) - hello_world.zig</h3>
            <pre class="zig"><code>//! Hello World - Port of GPUI&#x27;s hello_world.rs example
//!
//! This version uses ZapUI&#x27;s div element system, matching GPUI&#x27;s API closely.

const std = @import(&quot;std&quot;);
const zapui = @import(&quot;zapui&quot;);

// Element system
const div_mod = zapui.elements.div;
const div = div_mod.div;
const px = div_mod.px;

// Layout
const zaffy = zapui.zaffy;

// Rendering
const D3D11Renderer = zapui.renderer.d3d11_renderer.D3D11Renderer;
const D3D11TextRenderer = zapui.renderer.d3d11_text.D3D11TextRenderer;
const Scene = zapui.scene.Scene;

// Platform
const Win32 = zapui.platform.Win32Backend;

// Colors (matches GPUI&#x27;s color functions)
const color = zapui.color;
const rgb = color.rgb;
const red = color.red;
const green = color.green;
const blue = color.blue;
const yellow = color.yellow;
const black = color.black;
const white = color.white;

// ============================================================================
// HelloWorld
// ============================================================================

const HelloWorld = struct {
    text: []const u8,

    // Port of GPUI&#x27;s Render trait:
    //
    // impl Render for HelloWorld {
    //     fn render(&amp;mut self, _window: &amp;mut Window, _cx: &amp;mut Context&lt;Self&gt;) -&gt; impl IntoElement {
    //         div()
    //             .flex()
    //             .flex_col()
    //             .gap_3()
    //             .bg(rgb(0x505050))
    //             .size(px(500.0))
    //             .justify_center()
    //             .items_center()
    //             .text_xl()
    //             .text_color(rgb(0xffffff))
    //             .child(format!(&quot;Hello, {}!&quot;, &amp;self.text))
    //             .child(
    //                 div()
    //                     .flex()
    //                     .gap_2()
    //                     .child(div().size_8().bg(gpui::red()).border_1().border_dashed().rounded_md().border_color(gpui::white()))
    //                     .child(div().size_8().bg(gpui::green()).border_1().border_dashed().rounded_md().border_color(gpui::white()))
    //                     .child(div().size_8().bg(gpui::blue()).border_1().border_dashed().rounded_md().border_color(gpui::white()))
    //                     .child(div().size_8().bg(gpui::yellow()).border_1().border_dashed().rounded_md().border_color(gpui::white()))
    //                     .child(div().size_8().bg(gpui::black()).border_1().border_dashed().rounded_md().border_color(gpui::white()))
    //                     .child(div().size_8().bg(gpui::white()).border_1().border_dashed().rounded_md().border_color(gpui::black()))
    //             )
    //     }
    // }
    //
    fn render(self: *HelloWorld, label_buf: []u8) *div_mod.Div {
        // format!(&quot;Hello, {}!&quot;, &amp;self.text) -&gt; std.fmt.bufPrint
        const label = std.fmt.bufPrint(label_buf, &quot;Hello, {s}!&quot;, .{self.text}) catch &quot;Hello!&quot;;

        // Build the UI tree - matches GPUI almost exactly
        return div()
            .flex()
            .flex_col()
            .gap_3()
            .bg(rgb(0x505050))
            .size(px(500))
            .justify_center()
            .items_center()
            .text_xl()
            .text_color(rgb(0xffffff))
            .child(div().child_text(label)) // .child(&quot;text&quot;) -&gt; .child(div().child_text(&quot;text&quot;))
            .child(
            div()
                .flex()
                .gap_2()
                .child(div().size_8().bg(red()).border_1().border_dashed().rounded_md().border_color(white()))
                .child(div().size_8().bg(green()).border_1().border_dashed().rounded_md().border_color(white()))
                .child(div().size_8().bg(blue()).border_1().border_dashed().rounded_md().border_color(white()))
                .child(div().size_8().bg(yellow()).border_1().border_dashed().rounded_md().border_color(white()))
                .child(div().size_8().bg(black()).border_1().border_dashed().rounded_md().border_color(white()))
                .child(div().size_8().bg(white()).border_1().border_dashed().rounded_md().border_color(black())),
        );
    }
};

// ============================================================================
// Text Rendering Helper
// ============================================================================

/// Recursively draw text for div tree using D3D11TextRenderer
fn drawTextForDiv(
    d: *const div_mod.Div,
    layout_tree: *const zaffy.Zaffy,
    text_renderer: *D3D11TextRenderer,
    renderer: *D3D11Renderer,
    parent_x: f32,
    parent_y: f32,
) void {
    const nid = d.node_id orelse return;
    const lay = layout_tree.getLayout(nid);
    const x = parent_x + lay.location.x;
    const y = parent_y + lay.location.y;

    // Draw text content if present
    if (d.text_content_val) |text| {
        const text_w = text_renderer.measureText(text);
        const tx = x + (lay.size.width - text_w) / 2;
        const ty = y + lay.size.height / 2 + 6; // baseline offset
        const tc = d.text_color_val.toRgba();
        text_renderer.draw(renderer, text, tx, ty, .{ tc.r, tc.g, tc.b, tc.a });
    }

    // Recurse into children
    for (d.children[0..d.child_count]) |maybe_child| {
        if (maybe_child) |child| {
            drawTextForDiv(child, layout_tree, text_renderer, renderer, x, y);
        }
    }
}

// ============================================================================
// Main
// ============================================================================

const font_data = @embedFile(&quot;LiberationSans-Regular.ttf&quot;);

pub fn main() !void {
    const allocator = std.heap.page_allocator;

    // Platform
    var platform = try Win32.init();
    defer platform.deinit();

    const window = try Win32.createWindow(&amp;platform, .{
        .width = 500,
        .height = 500,
        .title = &quot;Hello World&quot;,
    });
    defer window.destroy();

    // Renderer
    var renderer = try D3D11Renderer.init(allocator, window.hwnd.?, 500, 500);
    defer renderer.deinit();

    // Text systems
    var text_system = try zapui.text_system.TextSystem.init(allocator);
    defer text_system.deinit();
    _ = try text_system.loadFontMem(font_data);

    var text_renderer = try D3D11TextRenderer.init(allocator, &amp;renderer, font_data, 20);
    defer text_renderer.deinit();

    // Layout &amp; scene
    var layout = zaffy.Zaffy.init(allocator);
    defer layout.deinit();

    var scene = Scene.init(allocator);
    defer scene.deinit();

    // Application state
    var state = HelloWorld{ .text = &quot;World&quot; };

    while (!window.shouldClose()) {
        for (window.pollEvents()) |e| {
            switch (e) {
                .key =&gt; |k| if (k.key == .escape) return,
                .resize =&gt; |r| renderer.resize(r.width, r.height) catch {},
                else =&gt; {},
            }
        }

        // Build UI
        div_mod.reset();
        var label_buf: [64]u8 = undefined;
        const root = state.render(&amp;label_buf);

        // Layout
        try root.buildWithTextSystem(&amp;layout, 16, &amp;text_system);
        layout.computeLayoutWithSize(root.node_id.?, 500, 500);

        // Render
        renderer.beginFrame();
        renderer.clear(0.314, 0.314, 0.314, 1.0); // rgb(0x505050)

        scene.clear();
        root.paint(&amp;scene, &amp;text_system, 0, 0, &amp;layout, null, null);
        scene.finish();
        renderer.drawScene(&amp;scene);

        // Draw text (separate from scene for now)
        drawTextForDiv(root, &amp;layout, &amp;text_renderer, &amp;renderer, 0, 0);

        renderer.present(true);
    }
}
</code></pre>
        </div>
    </div>
    
    <h2>üîó Links</h2>
    <ul>
        <li><a href="https://github.com/zed-industries/zed/blob/main/crates/gpui/examples/hello_world.rs" target="_blank">Original GPUI Source</a></li>
        <li><a href="hello_world.zig">ZapUI Port Source</a></li>
    </ul>
</body>
</html>
